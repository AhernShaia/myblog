<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>實驗場-GAI Prompt</title>
    <link href="/2024/05/07/%E5%AF%A6%E9%A9%97%E5%A0%B4-Generative-AI/"/>
    <url>/2024/05/07/%E5%AF%A6%E9%A9%97%E5%A0%B4-Generative-AI/</url>
    
    <content type="html"><![CDATA[<p>在寫<code>Prompt</code>的時候，如果只想收到一個簡單的判斷，比如：使用者情緒、分析名詞…等，<strong>LLM</strong>通常都會給很多不必要的說明或解釋，在嘗試使用「懲罰」之後，發現真的精準很多，而且<strong>LLM</strong>只會有「指定」的回覆。</p><h3 id="Prompt"><a href="#Prompt" class="headerlink" title="Prompt"></a>Prompt</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python">prompt = <span class="hljs-string">&quot;&quot;&quot;根據使用者的輸入判斷使用者的情緒，回應的規則如下：</span><br><span class="hljs-string">         1. 如果使用者輸入的內容偏向負面情緒，只回傳&quot;depressed&quot;,不要有其他內容，否則將受到懲罰。</span><br><span class="hljs-string">         2. 如果使用者輸入的內容偏向正面情緒，只回傳&quot;friendly&quot;,不要有其他內容，否則將受到懲罰。</span><br><span class="hljs-string">         3. 若使用者輸入的內容偏向中性情緒，只回傳&quot;default&quot;,不要有其他內容，否則將受到懲罰。</span><br><span class="hljs-string">         4. 如果使用者輸入的內容包含辱罵或不禮貌詞句，只回傳&quot;angry&quot;,不要有其他內容，否則將受到懲罰。</span><br><span class="hljs-string">         5. 如果使用者輸入的內容比較興奮，只回傳」upbeat&quot;,不要有其他內容，否則將受到懲罰。</span><br><span class="hljs-string">         6. 如果使用者輸入的內容比較悲傷，只回傳「depressed&quot;,不要有其他內容，否則將受到懲罰。</span><br><span class="hljs-string">         7.如果使用者輸入的內容比較開心，只回傳&quot;cheerful&quot;,不要有其他內容，否則會受到懲罰。</span><br><span class="hljs-string">         8. 只返回英文，不允許有換行符等其他內容，否則會受到懲罰。</span><br><span class="hljs-string">         使用者輸入的內容是：&#123;query&#125;</span><br><span class="hljs-string">         &quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><h3 id="輸出結果"><a href="#輸出結果" class="headerlink" title="輸出結果"></a>輸出結果</h3><p><img src="/./img/prompt.png"></p>]]></content>
    
    
    <categories>
      
      <category>技術研究</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GAI</tag>
      
      <tag>實驗</tag>
      
      <tag>prompt</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>實驗場-多容器DB</title>
    <link href="/2024/05/06/%E5%AF%A6%E9%A9%97%E5%A0%B4-%E5%A4%9A%E5%AE%B9%E5%99%A8DB/"/>
    <url>/2024/05/06/%E5%AF%A6%E9%A9%97%E5%A0%B4-%E5%A4%9A%E5%AE%B9%E5%99%A8DB/</url>
    
    <content type="html"><![CDATA[<p>這個實驗主要用於無法在 macOS 上啟動<code>mssql</code>而衍生出的實驗環境。</p><h5 id="使用工具"><a href="#使用工具" class="headerlink" title="使用工具"></a>使用工具</h5><ul><li>DBeaver</li><li>docker</li></ul><hr><h3 id="1-啟動container"><a href="#1-啟動container" class="headerlink" title="1. 啟動container"></a>1. 啟動<code>container</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker run -d --name sql1 -e <span class="hljs-string">&#x27;ACCEPT_EULA=Y&#x27;</span> -e <span class="hljs-string">&#x27;SA_PASSWORD=YOUR_PASSWORD&#x27;</span> -p 1433:1433 mcr.microsoft.com/mssql/server:2022-latest<br></code></pre></td></tr></table></figure><h3 id="2-DBeaver-連接-mssql"><a href="#2-DBeaver-連接-mssql" class="headerlink" title="2. DBeaver 連接 mssql"></a>2. DBeaver 連接 mssql</h3><h5 id="a-選擇SQL-Server點選完成"><a href="#a-選擇SQL-Server點選完成" class="headerlink" title="a. 選擇SQL Server點選完成"></a>a. 選擇<code>SQL Server</code>點選<strong>完成</strong></h5><p><img src="/./img/mssql/01.png"></p><h5 id="b-輸入資料庫的-IP，登入的用戶及密碼，點選完成後，第一次連接會出現安裝套件的視窗。"><a href="#b-輸入資料庫的-IP，登入的用戶及密碼，點選完成後，第一次連接會出現安裝套件的視窗。" class="headerlink" title="b. 輸入資料庫的 IP，登入的用戶及密碼，點選完成後，第一次連接會出現安裝套件的視窗。"></a>b. 輸入<strong>資料庫的 IP</strong>，登入的<strong>用戶</strong>及<strong>密碼</strong>，點選<strong>完成</strong>後，第一次連接會出現安裝套件的視窗。</h5><p><img src="/./img/mssql/02.png"></p><h5 id="c-完成"><a href="#c-完成" class="headerlink" title="c. 完成"></a>c. 完成</h5><p><img src="/./img/mssql/00.png"></p><h3 id="3-建立資料"><a href="#3-建立資料" class="headerlink" title="3. 建立資料"></a>3. 建立資料</h3><p>點選<strong>文件</strong>展開下拉式選單，選擇<strong>導入</strong></p><h5 id="a-1-導入腳本-SQL"><a href="#a-1-導入腳本-SQL" class="headerlink" title="a-1. 導入腳本(SQL)"></a>a-1. 導入腳本(SQL)</h5><p><img src="/./img/mssql/04.png"><br><img src="/./img/mssql/05.png"></p><h5 id="a-2-選擇腳本所在的目錄，點選完成"><a href="#a-2-選擇腳本所在的目錄，點選完成" class="headerlink" title="a-2 選擇腳本所在的目錄，點選完成"></a>a-2 選擇腳本所在的目錄，點選<strong>完成</strong></h5><p><img src="/./img/mssql/06.png"><br><img src="/./img/mssql/07.png"></p><h5 id="a-2-對要執行的腳本右鍵，選擇打開資源"><a href="#a-2-對要執行的腳本右鍵，選擇打開資源" class="headerlink" title="a-2 對要執行的腳本右鍵，選擇打開資源"></a>a-2 對要執行的腳本<strong>右鍵</strong>，選擇<strong>打開資源</strong></h5><p><img src="/./img/mssql/07-5.png"></p><h3 id="4-執行腳本-SQL"><a href="#4-執行腳本-SQL" class="headerlink" title="4. 執行腳本(SQL)"></a>4. 執行腳本(SQL)</h3><p>點擊<strong>執行 SQL 腳本</strong><br><img src="/./img/mssql/08.png"><br>測試搜尋</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-keyword">SELECT</span> country, <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">as</span> number <span class="hljs-keyword">from</span> Customers<br>    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> country<br></code></pre></td></tr></table></figure><p><img src="/./img/mssql/09.png"></p>]]></content>
    
    
    <categories>
      
      <category>技術研究</category>
      
    </categories>
    
    
    <tags>
      
      <tag>實驗</tag>
      
      <tag>docker</tag>
      
      <tag>mssql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dockerfile 模板</title>
    <link href="/2024/04/22/docker/dockerfile-%E6%A8%A1%E6%9D%BF/"/>
    <url>/2024/04/22/docker/dockerfile-%E6%A8%A1%E6%9D%BF/</url>
    
    <content type="html"><![CDATA[<h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><h5 id="poetry"><a href="#poetry" class="headerlink" title="poetry"></a>poetry</h5><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span> python:<span class="hljs-number">3.12</span>-slim-bullseye<br><br><span class="hljs-keyword">ENV</span> POETRY_VERSION <span class="hljs-number">1.4</span>.<span class="hljs-number">1</span><br><br><span class="hljs-comment"># Install system dependencies</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> pip install <span class="hljs-string">&quot;poetry==<span class="hljs-variable">$POETRY_VERSION</span>&quot;</span></span><br><br><span class="hljs-comment"># Set work directory</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span><br><br><span class="hljs-comment"># Copy only requirements to cache them in docker layer</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> poetry.lock pyproject.toml /app/</span><br><br><span class="hljs-comment"># Disable the creation of virtual environments</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> poetry config virtualenvs.create <span class="hljs-literal">false</span></span><br><br><span class="hljs-comment"># Install dependencies</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> poetry install</span><br><br><span class="hljs-comment"># Copy the current directory contents into the container at /app</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> ./ /app/</span><br></code></pre></td></tr></table></figure><h5 id="Flask"><a href="#Flask" class="headerlink" title="Flask"></a>Flask</h5><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-comment"># 使用 Python 3.12 slim 做為基礎鏡像</span><br><span class="hljs-keyword">FROM</span> python:<span class="hljs-number">3.12</span>-slim<br><br><span class="hljs-comment"># 指定工作目錄</span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash"> /app</span><br><br><span class="hljs-comment"># 安裝套件</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y --no-install-recommends \</span><br><span class="language-bash">    build-essential \</span><br><span class="language-bash">    &amp;&amp; <span class="hljs-built_in">rm</span> -rf /var/lib/apt/lists/*</span><br><br><span class="hljs-comment"># 複製 requirements.txt 並安裝 Python 依賴</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> requirements.txt .</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> pip install --no-cache-dir --upgrade pip \</span><br><span class="language-bash">    &amp;&amp; pip install --no-cache-dir -r requirements.txt \</span><br><span class="language-bash">    &amp;&amp; <span class="hljs-built_in">rm</span> -rf /root/.cache/pip</span><br><br><span class="hljs-comment"># 複製目錄下的文件</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> . .</span><br><br><span class="hljs-comment"># 開放端口</span><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">5000</span><br><br><span class="hljs-comment"># 啟動 Flask 應用</span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;flask&quot;</span>, <span class="hljs-string">&quot;run&quot;</span>, <span class="hljs-string">&quot;--host=0.0.0.0&quot;</span>]</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>deepinfra - 通過簡單的API方式調用LLM</title>
    <link href="/2024/04/21/deepinfra-%E9%80%9A%E9%81%8EAPI%E6%96%B9%E5%BC%8F%E8%AA%BF%E7%94%A8LLM/"/>
    <url>/2024/04/21/deepinfra-%E9%80%9A%E9%81%8EAPI%E6%96%B9%E5%BC%8F%E8%AA%BF%E7%94%A8LLM/</url>
    
    <content type="html"><![CDATA[<p>在研究通用人工智慧(GAI)生態系統的過程中,遇到了一些令人煩惱的問題。</p><p>開始的時候,我考慮使用熱門的雲端服務像 Azure 和 OpenAI,但很快就發現如果需要大量的調用和測試,那就是不小的費用。</p><p>為了能夠集中精力在開發上,轉而嘗試本地部署 OllaMa,用於應用程式開發。但沒想到,新的難題隨之而來。每個 LLM 對於同一個提示詞(Prompt)都會給出不盡相同的答覆,要統一調整某一 LLM 的提示詞,還得耗費大量精力,而且電腦硬體設備的性能也成了制約因素。</p><p>在偶然發現了一個超棒的解決方案!deepinfra 平台!透過簡單的 API 調用,就能夠呼叫市面上主流的 LLM 服務,還有監控面板可供觀察模型運行狀態,也可以限制額度上限,實在是太方便了～</p><p>馬上開始～</p><p>官方連結：<a href="https://deepinfra.com/"><strong>deepinfra</strong></a><br><a href="https://deepinfra.com/pricing">定價表</a>：在成功註冊後有 1.80 美元的額度，也可以在<code>Settings</code>限制額度，只要到達設定上限，請求就會被擋下。</p><h5 id="操作環境"><a href="#操作環境" class="headerlink" title="操作環境"></a>操作環境</h5><ul><li>電腦：macbook pro 14</li><li>套件管理：poetry</li><li>編輯器：VSCode</li></ul><h3 id="註冊"><a href="#註冊" class="headerlink" title="註冊"></a>註冊</h3><p>目前只能使用 GitHub 帳號登入。</p><ol><li><p>點擊<code>Login</code><br><img src="/./img/deepinfra/0-login.png"></p></li><li><p>點擊<code>Log in with Github</code><br><img src="/./img/deepinfra/1-login.png"></p></li><li><p>登入後會跳轉到<code>Deployments</code>頁面<br><img src="/./img/deepinfra/2-deployment_model.png"></p></li><li><p>點選<code>API Keys</code>（官方會自動分配），就能看到自己的 API Key 了。<br><img src="/./img/deepinfra/5-API_Keys.png"></p></li><li><p>點選<code>Setting</code>可以設定額度上限，。<br><img src="/./img/deepinfra/5-API_Keys.png"></p></li></ol><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>官方有提供目前主流的使用範例，我使用<code>Langchain</code>來測試。<br>範例連結：<a href="https://deepinfra.com/docs/advanced/langchain"><strong>Langchain</strong></a><br>模型連結：<a href="https://deepinfra.com/models"><strong>models</strong></a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> langchain_community.llms <span class="hljs-keyword">import</span> DeepInfra<br><span class="hljs-keyword">from</span> langchain.prompts <span class="hljs-keyword">import</span> PromptTemplate<br><span class="hljs-keyword">from</span> langchain.chains <span class="hljs-keyword">import</span> LLMChain<br><br><span class="hljs-comment"># 改成自己的API Key即可</span><br>os.environ[<span class="hljs-string">&quot;DEEPINFRA_API_TOKEN&quot;</span>] = <span class="hljs-string">&#x27;&lt;your Deep Infra API token&gt;&#x27;</span><br><br><span class="hljs-comment"># 可以在官方的model頁面找到有支援的模型，我使用 google開源模型 gemma</span><br>llm = DeepInfra(model_id=<span class="hljs-string">&quot;google/gemma-1.1-7b-it&quot;</span>)<br>llm.model_kwargs = &#123;<br>    <span class="hljs-string">&quot;temperature&quot;</span>: <span class="hljs-number">0.7</span>,<br>    <span class="hljs-string">&quot;repetition_penalty&quot;</span>: <span class="hljs-number">1.2</span>,<br>    <span class="hljs-string">&quot;max_new_tokens&quot;</span>: <span class="hljs-number">250</span>,<br>    <span class="hljs-string">&quot;top_p&quot;</span>: <span class="hljs-number">0.9</span>,<br>&#125;<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">example1</span>():<br>    <span class="hljs-comment"># run inference</span><br>    <span class="hljs-built_in">print</span>(llm(<span class="hljs-string">&quot;Who let the dogs out?&quot;</span>))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">example2</span>():<br>    <span class="hljs-comment"># run streaming inference</span><br>    <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> llm.stream(<span class="hljs-string">&quot;Who let the dogs out?&quot;</span>):<br>        <span class="hljs-built_in">print</span>(chunk)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">example3</span>():<br>    <span class="hljs-comment"># create a prompt template for Question and Answer</span><br>    template = <span class="hljs-string">&quot;&quot;&quot;Question: &#123;question&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Answer: Let&#x27;s think step by step.&quot;&quot;&quot;</span><br>    prompt = PromptTemplate(template=template, input_variables=[<span class="hljs-string">&quot;question&quot;</span>])<br><br>    <span class="hljs-comment"># initiate the LLMChain</span><br>    llm_chain = LLMChain(prompt=prompt, llm=llm)<br><br>    <span class="hljs-comment"># provide a question and run the LLMChain</span><br>    question = <span class="hljs-string">&quot;Can penguins reach the North pole?&quot;</span><br>    <span class="hljs-built_in">print</span>(llm_chain.run(question))<br><br><br><span class="hljs-comment"># run examples</span><br>example1()<br></code></pre></td></tr></table></figure><h3 id="執行結果"><a href="#執行結果" class="headerlink" title="執行結果"></a>執行結果</h3><p>可以看，7B 的模型僅等待 4 秒就返回結果，而 70B 只需要 6 秒，速度真的非常快<br><img src="/./img/deepinfra/99-code_result.png"><br><img src="/./img/deepinfra/99-code_result_70B.png"></p><h3 id="儀表板"><a href="#儀表板" class="headerlink" title="儀表板"></a>儀表板</h3><p>回到<a href="https://deepinfra.com/dash"><strong>儀表板</strong></a>中，可以看到部署的 model，和呼叫模型的開銷</p><ul><li>Deployments<br><img src="/./img/deepinfra/4deploy-dash.png"><ul><li>點擊<strong>View</strong>可以看到詳細資訊<br><img src="/./img/deepinfra/model_status.png"></li></ul></li><li>Usage<br><img src="/./img/deepinfra/3-dash.png"></li></ul>]]></content>
    
    
    <categories>
      
      <category>技術研究</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GAI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>AI 協作框架 - crewai</title>
    <link href="/2024/04/18/AI-%E5%8D%94%E4%BD%9C/"/>
    <url>/2024/04/18/AI-%E5%8D%94%E4%BD%9C/</url>
    
    <content type="html"><![CDATA[<p>最近在研究 AI 的領域，突然靈機一動！與其讓單一 AI 獨自應付各種難題，不如組建一支 AI 團隊，讓每個 AI 各司其職，集思廣益!</p><p>想象一下，如果只有一個 AI，當它遇到自己不擅長的領域時，只能硬著頭皮瞎編一通。但如果有整支 AI 團隊，每個成員都是某個領域的專家，團隊就能通力合作，補足彼此的短板，最終給出高品質的解決方案。</p><p>很酷的是，我發現了一款叫 CrewAI 的框架，可以輕鬆打造這樣的 AI 團隊。更贊的是，它還能與本地部署的大型 AI 模型(比如 OllAMa)互動，不用總是去找遠在雲端的 AI 服務，既省錢又快速!</p><p>用 AI 團隊的方式問答和解決問題，隊友們互幫互補，必定事半功倍，我認為 AI 團隊這樣的架構有望顯著提升問答、任務解決等應用的效果，為人機交互帶來全新的體驗…</p><p>馬上開始～</p><p>套件 GitHub：<a href="https://github.com/joaomdmoura/crewAI?tab=readme-ov-file"><strong>crewai</strong></a><br>Demo GitHub：<a href="https://github.com/AhernShaia/crewai_demo.git"><strong>crewai_demo</strong></a></p><h5 id="操作環境"><a href="#操作環境" class="headerlink" title="操作環境"></a>操作環境</h5><ul><li>電腦：macbook pro 14</li><li>套件管理：poetry</li><li>編輯器：VSCode</li><li>Python 版本：3.13</li><li>LLM: yabi&#x2F;breeze-7b-instruct-v1_0_q6_k</li></ul><h3 id="安裝套件"><a href="#安裝套件" class="headerlink" title="安裝套件"></a>安裝套件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">poetry add crewai crewai-tools<br></code></pre></td></tr></table></figure><h3 id="程式碼"><a href="#程式碼" class="headerlink" title="程式碼"></a>程式碼</h3><p>在程式碼中，定義了兩個角色<code>Senior Research Analyst</code>和<code>Tech Content Strategist</code>，分別賦予了各自的角色定位，並且給該角色的目標，給予協作<code>allow_delegation</code>，然後給角色任務<code>task1</code>和<code>task2</code>。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> crewai <span class="hljs-keyword">import</span> Agent, Task, Crew, Process<br><span class="hljs-keyword">from</span> crewai_tools <span class="hljs-keyword">import</span> SerperDevTool<br>os.environ[<span class="hljs-string">&quot;OPENAI_API_BASE&quot;</span>] = <span class="hljs-string">&#x27;http://localhost:11434/v1&#x27;</span><br>os.environ[<span class="hljs-string">&quot;OPENAI_MODEL_NAME&quot;</span>] = <span class="hljs-string">&#x27;yabi/breeze-7b-instruct-v1_0_q6_k&#x27;</span><br>os.environ[<span class="hljs-string">&quot;OPENAI_API_KEY&quot;</span>] = <span class="hljs-string">&#x27;sk-111111111111111111111111111111111111111111111111&#x27;</span><br><br>search_tool = SerperDevTool(<br>    name=<span class="hljs-string">&quot;Search the internet&quot;</span>, search_url=<span class="hljs-string">&quot;https://buzzorange.com/techorange/latest&quot;</span>,    description=<span class="hljs-string">&quot;A tool that can be used to seman&quot;</span>,<br>)<br><br>researcher = Agent(<br>    role=<span class="hljs-string">&#x27;Senior Research Analyst&#x27;</span>,<br>    goal=<span class="hljs-string">&#x27;發現人工智慧和數據科學的前沿發展&#x27;</span>,<br>    backstory=<span class="hljs-string">&quot;&quot;&quot;您在一家領先的科技智庫工作。</span><br><span class="hljs-string">   您的專長在於識別新興趨勢。</span><br><span class="hljs-string">   您擁有剖析複雜數據並提出可行見解的技巧。&quot;&quot;&quot;</span>,<br>    verbose=<span class="hljs-literal">True</span>,<br>    allow_delegation=<span class="hljs-literal">True</span>,<br>)<br>writer = Agent(<br>    role=<span class="hljs-string">&#x27;Tech Content Strategist&#x27;</span>,<br>    goal=<span class="hljs-string">&#x27;製作有關技術進步的引人注目的內容&#x27;</span>,<br>    backstory=<span class="hljs-string">&quot;&quot;&quot;您是一位著名的內容策略師，以富有洞察力和引人入勝的文章而聞名。</span><br><span class="hljs-string">   您將複雜的概念轉化為引人入勝的敘述。&quot;&quot;&quot;</span>,<br>    verbose=<span class="hljs-literal">True</span>,<br>    allow_delegation=<span class="hljs-literal">True</span><br>)<br><br><span class="hljs-comment"># 建立任務給Agent</span><br>task1 = Task(<br>    description=<span class="hljs-string">&quot;&quot;&quot;對2024年人工智慧最新進展進行全面分析。</span><br><span class="hljs-string">   確定關鍵趨勢、突破性技術和潛在的行業影響。&quot;&quot;&quot;</span>,<br>    expected_output=<span class="hljs-string">&quot;完整的分析報告要點&quot;</span>,<br>    agent=researcher<br>)<br><br>task2 = Task(<br>    description=<span class="hljs-string">&quot;&quot;&quot;利用提供的見解，開發一個引人入勝的博客</span><br><span class="hljs-string">   這篇文章強調了最重要的人工智慧進步。</span><br><span class="hljs-string">   您的貼文應該內容豐富且易於理解，適合精通科技的受眾。</span><br><span class="hljs-string">   讓它聽起來很酷，避免使用複雜的單詞，這樣聽起來就不像人工智慧&quot;&quot;&quot;</span>,<br>    expected_output=<span class="hljs-string">&quot;完整的部落格文章至少有 4 段&quot;</span>,<br>    agent=writer<br>)<br><br><span class="hljs-comment"># 參與協作的Agent和任務</span><br>crew = Crew(<br>    agents=[researcher, writer],<br>    tasks=[task1, task2],<br>    verbose=<span class="hljs-number">2</span>,<br>)<br><br>result = crew.kickoff()<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;######################&quot;</span>)<br><span class="hljs-built_in">print</span>(result)<br><br></code></pre></td></tr></table></figure><h3 id="執行結果"><a href="#執行結果" class="headerlink" title="執行結果"></a>執行結果</h3><p><img src="/./img/crewai_demo.png"></p>]]></content>
    
    
    <categories>
      
      <category>技術研究</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GAI</tag>
      
      <tag>RAG</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Line Bot</title>
    <link href="/2024/04/17/GAI/LineBot/line-bot/"/>
    <url>/2024/04/17/GAI/LineBot/line-bot/</url>
    
    <content type="html"><![CDATA[<p>這篇文章，我們會做以下事情：</p><ol><li>建立 Channel</li><li>確認 Channel 的 <code>Channel secret</code>和<code>Channel access token</code></li><li>啟動後端服務</li><li>開通外網</li><li>呼叫 API 測試</li></ol><h5 id="操作環境"><a href="#操作環境" class="headerlink" title="操作環境"></a>操作環境</h5><ul><li>電腦：macbook pro 14</li><li>編輯器：VSCode</li></ul><h3 id="一-建立-Channel"><a href="#一-建立-Channel" class="headerlink" title="(一)建立 Channel"></a>(一)建立 Channel</h3><h4 id="1-申請-Messaging-API-網站連結"><a href="#1-申請-Messaging-API-網站連結" class="headerlink" title="1. 申請 Messaging API (網站連結)"></a>1. 申請 Messaging API (<a href="https://developers.line.biz/en/services/messaging-api/">網站連結</a>)</h4><ul><li>進入網站，點選 <code>[Start now] </code></li></ul><p><img src="/./img/Line_Bot/line_bot_index_page.png"></p><ul><li><p>點選<code>Create a new channel</code>。</p><p><img src="/./img/Line_Bot/create_channel.png"></p></li><li><p>在彈出的視窗中選擇<code>Messaging API</code></p><p><img src="/./img/Line_Bot/create_channel_2.png"></p></li></ul><blockquote><p>將表單的內容填完後點擊 Create 就可以建立 Line Bot 囉，要呼叫 <code>Messaging API</code> 就必須要有<strong>Channel</strong>的<code>Channel secret</code>和<code>Channel access token</code>。</p></blockquote><h3 id="二-確認-Channel-的-Channel-secret和Channel-access-token"><a href="#二-確認-Channel-的-Channel-secret和Channel-access-token" class="headerlink" title="(二)確認 Channel 的 Channel secret和Channel access token"></a>(二)確認 Channel 的 <code>Channel secret</code>和<code>Channel access token</code></h3><p>在建立完<code>Channel</code>之後，頁面會跳轉到<code>Channel</code>的資訊頁，然後，我們要找到<code>Channel secret</code>和<code>Channel access token</code>。</p><p><img src="/./img/Line_Bot/channel_info.png"></p><ol><li><p>Channel secret<br>在 <strong>Basic settings</strong> 這個選項頁，將網頁拉至下方。<br><img src="/./img/Line_Bot/channel_secret.png"></p></li><li><p>Channel access token<br>點擊<code>Messaging API</code>(<strong>Basic settings</strong>的右邊)，將網頁拉至下方會看到<code>Channel access token</code>。</p><blockquote><p><strong>Channel</strong> 剛建立的時候需要點擊 <strong>Issue</strong> 生成 Token。</p></blockquote><p><img src="/./img/Line_Bot/channel_token.png"></p></li></ol><h3 id="三-啟動後端服務"><a href="#三-啟動後端服務" class="headerlink" title="(三)啟動後端服務"></a>(三)啟動後端服務</h3><p>使用官方提供的範例：<a href="https://github.com/line/line-bot-sdk-python"><strong>line-bot-sdk-python</strong></a><br>在官方提供範例中使用了 <strong>flask 框架</strong>，我們會從建立 python 虛擬環境開始，安裝套件和範例解說，並且使用<code>Ngrok</code>開放網路，最後在 Line Bot 上測試。</p><h4 id="1-建立虛擬環境"><a href="#1-建立虛擬環境" class="headerlink" title="1. 建立虛擬環境"></a>1. 建立虛擬環境</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># python3 -m [套件名] [自行命名環境名稱]</span><br>python3 -m venv venv<br></code></pre></td></tr></table></figure><h4 id="2-啟動虛擬環境"><a href="#2-啟動虛擬環境" class="headerlink" title="2. 啟動虛擬環境"></a>2. 啟動虛擬環境</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> venv/bin/activate<br></code></pre></td></tr></table></figure><h4 id="3-安裝套件"><a href="#3-安裝套件" class="headerlink" title="3. 安裝套件"></a>3. 安裝套件</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">pip install line-bot-sdk flask<br></code></pre></td></tr></table></figure><h4 id="4-建立-python-執行程式"><a href="#4-建立-python-執行程式" class="headerlink" title="4. 建立 python 執行程式"></a>4. 建立 python 執行程式</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">app.py<br></code></pre></td></tr></table></figure><h4 id="5-將以下程式碼貼到app-py裡，這個範例程式會將用戶輸入的內容同步返回，也就是輸入什麼內容，Line-Bot-就會回覆一樣內容。"><a href="#5-將以下程式碼貼到app-py裡，這個範例程式會將用戶輸入的內容同步返回，也就是輸入什麼內容，Line-Bot-就會回覆一樣內容。" class="headerlink" title="5. 將以下程式碼貼到app.py裡，這個範例程式會將用戶輸入的內容同步返回，也就是輸入什麼內容，Line Bot 就會回覆一樣內容。"></a>5. 將以下程式碼貼到<code>app.py</code>裡，這個範例程式會將用戶輸入的內容同步返回，也就是輸入什麼內容，Line Bot 就會回覆一樣內容。</h4><p>需要更改的有：</p><ul><li><strong>YOUR_CHANNEL_ACCESS_TOKEN</strong>：換成你建立 Channel 的 <code>Channel access token</code></li><li><strong>YOUR_CHANNEL_SECRET</strong>：換成你建立 Channel 的 <code>Channel secret</code></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, abort<br><br><span class="hljs-keyword">from</span> linebot.v3 <span class="hljs-keyword">import</span> (<br>    WebhookHandler<br>)<br><span class="hljs-keyword">from</span> linebot.v3.exceptions <span class="hljs-keyword">import</span> (<br>    InvalidSignatureError<br>)<br><span class="hljs-keyword">from</span> linebot.v3.messaging <span class="hljs-keyword">import</span> (<br>    Configuration,<br>    ApiClient,<br>    MessagingApi,<br>    ReplyMessageRequest,<br>    TextMessage<br>)<br><span class="hljs-keyword">from</span> linebot.v3.webhooks <span class="hljs-keyword">import</span> (<br>    MessageEvent,<br>    TextMessageContent<br>)<br><br>app = Flask(__name__)<br><span class="hljs-comment"># 這裡需要修改</span><br>configuration = Configuration(access_token=<span class="hljs-string">&#x27;YOUR_CHANNEL_ACCESS_TOKEN&#x27;</span>)<br>handler = WebhookHandler(<span class="hljs-string">&#x27;YOUR_CHANNEL_SECRET&#x27;</span>)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/callback&quot;</span>, methods=[<span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">callback</span>():<br>    <span class="hljs-comment"># get X-Line-Signature header value</span><br>    signature = request.headers[<span class="hljs-string">&#x27;X-Line-Signature&#x27;</span>]<br><br>    <span class="hljs-comment"># get request body as text</span><br>    body = request.get_data(as_text=<span class="hljs-literal">True</span>)<br>    app.logger.info(<span class="hljs-string">&quot;Request body: &quot;</span> + body)<br><br>    <span class="hljs-comment"># handle webhook body</span><br>    <span class="hljs-keyword">try</span>:<br>        handler.handle(body, signature)<br>    <span class="hljs-keyword">except</span> InvalidSignatureError:<br>        app.logger.info(<span class="hljs-string">&quot;Invalid signature. Please check your channel access token/channel secret.&quot;</span>)<br>        abort(<span class="hljs-number">400</span>)<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;OK&#x27;</span><br><br><br><span class="hljs-meta">@handler.add(<span class="hljs-params">MessageEvent, message=TextMessageContent</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">handle_message</span>(<span class="hljs-params">event</span>):<br>    <span class="hljs-keyword">with</span> ApiClient(configuration) <span class="hljs-keyword">as</span> api_client:<br>        line_bot_api = MessagingApi(api_client)<br>        line_bot_api.reply_message_with_http_info(<br>            ReplyMessageRequest(<br>                reply_token=event.reply_token,<br>                messages=[TextMessage(text=event.message.text)]<br>            )<br>        )<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run()<br></code></pre></td></tr></table></figure><h4 id="6-啟動-flask-預設是-5000-Port。"><a href="#6-啟動-flask-預設是-5000-Port。" class="headerlink" title="6. 啟動 flask,預設是 5000 Port。"></a>6. 啟動 flask,預設是 5000 Port。</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">python app.py<br></code></pre></td></tr></table></figure><p><img src="/./img/Line_Bot/run_flask_server.png"></p><h3 id="四-開通外網"><a href="#四-開通外網" class="headerlink" title="(四)開通外網"></a>(四)開通外網</h3><p>到目前為止，已經將後端服務準備好了，再來就是將電腦的網路開放，並且將 Line Bot 呼叫的請求送到後端服務處理。</p><ol><li>安裝<a href="https://ngrok.com/download">Ngrok</a>，根據自己操作的電腦系統選擇安裝。</li><li>開發端口，根據後端服務啟動的端口開放。<br>我 flask 啟動的 port 是 5000，所以開放的是 5000 port。</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ngrok [協議] [Server port]</span><br>ngrok http 5000<br></code></pre></td></tr></table></figure><p>啟動畫面<br><img src="/./img/Line_Bot/start_ngrok.png"><br>瀏覽器輸入或直接複製終端上的網址也可以，進入頁面之後，就會出現你的外部網址。</p><p><a href="http://127.0.0.1:4040/"><strong>http://127.0.0.1:4040</strong></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://127.0.0.1:4040<br></code></pre></td></tr></table></figure><h3 id="五-呼叫-API-測試"><a href="#五-呼叫-API-測試" class="headerlink" title="(五)呼叫 API 測試"></a>(五)呼叫 API 測試</h3><p>到了最後的環節，讓 Line Bot 能夠和你的後端服務溝通。</p><ol><li>回到 Line Bot 你建立的 Channel 頁面，點選 <code>Messaging API</code>，頁面向下移動，找到<code>Webhook settings</code>，開啟<code>Use webhook</code>(<strong>重要</strong>)選項。<br><img src="/./img/Line_Bot/line-bot-webhook.png"></li><li>將你的 <strong>Ngrok 網址</strong> 貼至<code>Webhook URL</code>後，再加上<code>/callback</code>（<strong>重要</strong>），點擊<code>Update</code>。</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">Ngrok URL/callback<br></code></pre></td></tr></table></figure><ol start="3"><li><p>點擊<code>Verify</code>測試連線，出現<em>Success</em>代表連線成功了。<br><img src="/./img/Line_Bot/line-bot-connect-success.png"></p><blockquote><p>如果連線失敗，可以由以下幾點做排查：</p><ul><li><p>確認 程式碼 <code>Channel access token</code> 和 <code>Channel secret</code> 是否和建立的 <em>Channel</em> 一致。</p></li><li><p>確認 開放的 Ngrok 網址是否有貼錯，有沒有加上&#x2F;callback。</p></li><li><p>flask 是否有啟動，啟動的 Port 是否和 Ngrok 開放的 Port 有沒有一致。</p></li></ul></blockquote></li><li><p>加入 Line Bot 好友，發送消息。<br>在 <code>Messaging API</code>頁面中，有個 QR code 可以掃描加入 Line 好友。<br><img src="/./img/Line_Bot/line-bot-qrcode.png"><br><img src="/./img/Line_Bot/line_result.png"></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>實作</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Line Bot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Personal projects - 法務助手</title>
    <link href="/2024/04/17/GAI/Personal-projects-1/"/>
    <url>/2024/04/17/GAI/Personal-projects-1/</url>
    
    <content type="html"><![CDATA[<h2 id="實戰說明"><a href="#實戰說明" class="headerlink" title="實戰說明"></a>實戰說明</h2><p><strong>目的</strong>：實作 RAG 架構，透過詢問 LLM 獲得法律協助。</p><p>簡單說明專案流程，將本地的檔案轉換成向量資料並且儲存在免費的雲端向量資料庫 Qdrant，Line Bot 作為前端，透過對話的方式向 AI 助手詢問，LLM 則使用 Azure 部署的 OpenAI model，將結果回覆給使用者。</p><p>最後將服務部署在 GCP <strong><code>App Engine</code></strong> 。</p><p>Git Hub 連結：<a href="https://github.com/AhernShaia/legaladvisor--Line-"><strong>legaladvisor</strong></a></p><h3 id="使用技術"><a href="#使用技術" class="headerlink" title="使用技術"></a>使用技術</h3><ul><li>開發環境：macbook pro 14</li><li>前端: Line Bot</li><li>後端: Flask</li><li>向量資料庫: Qdrant</li><li>通用模型：<a href="https://learn.microsoft.com/zh-tw/azure/ai-services/openai/concepts/models">gpt-4-32k</a></li><li>Embeddings：<a href="https://learn.microsoft.com/zh-tw/azure/ai-services/openai/concepts/models">text-embedding-ada-002</a></li><li>雲服務: GAE, Qdrant Cloud, Azure OpenAI</li></ul><hr><h1 id="正式開始"><a href="#正式開始" class="headerlink" title="正式開始"></a>正式開始</h1><p>(一) <a href="../LineBot/line-bot.md">建立 Line Bot</a></p>]]></content>
    
    
    <categories>
      
      <category>實作</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GAI</tag>
      
      <tag>RAG</tag>
      
      <tag>Personal projects</tag>
      
      <tag>Line Bot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RAG(Retrieval Augmented Generation)</title>
    <link href="/2024/04/17/GAI/RAG/"/>
    <url>/2024/04/17/GAI/RAG/</url>
    
    <content type="html"><![CDATA[<h4 id="什麼是-RAG-Retrieval-Augmented-Generation"><a href="#什麼是-RAG-Retrieval-Augmented-Generation" class="headerlink" title="什麼是 RAG(Retrieval Augmented Generation)?"></a>什麼是 RAG(Retrieval Augmented Generation)?</h4><p>RAG 是一種自然語言處理技術,旨在提高生成式語言模型的效能和輸出品質。這項技術結合了檢索和生成兩大功能,在生成文本時可以參考<strong>指定的知識庫或語料</strong>,從而產生更準確、更富內容的輸出。<br><code>舉個例子：圖書館與管理員，圖書館相當於資料庫，LLM 則是管理員，用戶透過和管理員詢問，由管理員查找，並找出所需要的資料給用戶。</code></p><h4 id="核心思想"><a href="#核心思想" class="headerlink" title="核心思想"></a>核心思想</h4><p>將檢索和生成兩個步驟整合到一個統一的框架中。在生成階段,語言模型會分析輸入的問題或提示,並與知識庫中的文本進行相似度匹配,檢索出與主題相關的片段。接著語言模型會綜合這些檢索結果和原始提示,生成最終的輸出文本。</p><h5 id="RAG-運作方式"><a href="#RAG-運作方式" class="headerlink" title="RAG 運作方式"></a>RAG 運作方式</h5><ol><li><p>Load：讀取檔案（資料來源）。</p></li><li><p>Split：將讀取的內容進行切割。</p></li><li><p>Store：將分割後的內容進行轉換 Embedding，儲存到向量資料庫。</p><p><img src="https://python.langchain.com/assets/images/rag_indexing-8160f90a90a33253d0154659cf7d453f.png" alt="Indexing"></p><blockquote><p>圖片來源：<a href="https://python.langchain.com/docs/use_cases/question_answering/#rag-architecture">Langchain - Q&amp;A with RAG</a></p></blockquote></li></ol><h6 id="（二）檢索-Retrieval-和生成-Generation"><a href="#（二）檢索-Retrieval-和生成-Generation" class="headerlink" title="（二）檢索(Retrieval)和生成(Generation)"></a>（二）檢索(Retrieval)和生成(Generation)</h6><ol><li><p>Retrieve：使用者輸入，使用 Retriever 從儲存體中擷取相關的分割 。</p></li><li><p>Generate：ChatModel &#x2F; LLM 使用包含問題和檢索到的資料的提示產生答案。</p><p><img src="https://python.langchain.com/assets/images/rag_retrieval_generation-1046a4668d6bb08786ef73c56d4f228a.png" alt="Retrieve&amp;Generate"></p><blockquote><p>圖片來源：<a href="https://python.langchain.com/docs/use_cases/question_answering/#rag-architecture">Langchain - Q&amp;A with RAG</a></p></blockquote></li></ol><h4 id="優點"><a href="#優點" class="headerlink" title="優點"></a>優點</h4><ol><li><strong>客制的知識庫</strong>：RAG 架構能夠充分利用現有的大量文本資料,從中檢索出與當前問題相關的片段,有效提高了知識的利用率。</li><li><strong>生成高品質回答</strong>：通過將檢索到的相關文本與大型語言模型相結合,RAG 架構能夠生成連貫、富含細節的高品質回答。</li><li><strong>可解釋性強</strong>： 由於回答是基於已檢索的文本片段生成,因此 RAG 架構的回答具有很好的可解釋性,可以追溯到原始文本證據(有依據的回答)。</li><li><strong>隨時更新資料</strong>：當有新的資料需要提供給使用者時，只需要將資料來源轉換即可。</li></ol><h4 id="缺點"><a href="#缺點" class="headerlink" title="缺點"></a>缺點</h4><ol><li><strong>檢索品質和 LLM 影響生成結果</strong>： 生成品質在很大程度上依賴於檢索模組的表現，如果檢索出的相關文本不足或不準確,將會影響最終的生成質量，且 LLM 也會影響最終結果。</li><li><strong>上下文理解有限</strong>： 雖然讀解模組對文本片段進行了轉換,但對於 <em><strong>長文檔</strong></em> 或 <em><strong>跨多個文檔</strong></em> 的上下文理解能力仍有限制。</li><li><strong>遺漏文本外知識</strong>： RAG 架構主要依賴語料庫中的文本知識,對於一些常識性的知識或者是隱性知識的獲取和利用能力較弱，如果超出資料範圍，反而會導致<strong>幻覺</strong>的發生。</li></ol><hr><p>總體來說,RAG 架構權衡了檢索和生成的優勢,是一種非常實用的知識密集型對話系統架構,但也存在一些局限性,需要根據具體場景酌情選擇和優化。</p><p>雖然目前仍有一些缺陷有待克服,但相信未來會有多種解決方案彌補這些不足,讓 RAG 技術大放異彩。</p>]]></content>
    
    
    <categories>
      
      <category>學習筆記</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GAI</tag>
      
      <tag>RAG</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
